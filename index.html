<!DOCTYPE html>
<html>

<head>
    <title>Color</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .main {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .right-panel {
            padding: 13px 15px 13px 30px;
            background-color: #b5b5b5;
        }
        
        .second .right-panel {
            padding: 31px 15px 31px 30px;
        }
        
        .right-panel>div {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 210px;
        }
        
        .left-panel {
            padding: 10px;
            background-color: #eee;
            border: 1px solid #ccc;
        }
        
        .left-panel img.food {
            border: 1px solid #cecece;
            padding: 2px;
            margin: 2px;
            border-radius: 8px;
            box-shadow: 0px 0px 7px 0px rgb(158 158 158 / 69%);
            opacity: 0.5;
            transition: all .2s ease-in-out;
        }
        
        .progress-container {
            height: 10px;
            border-radius: 5px;
            background-color: #f4f3f0;
            width: 100px;
        }
        
        .progress-container .progress {
            height: 100%;
            width: 0;
            border-radius: 5px;
            background: #e5e4dc;
            transition: width 0.4s ease;
        }
        
        #Sweet {
            background-color: #9c27b0;
        }
        
        #Sour {
            background-color: #f44336;
        }
        
        #Salty {
            background-color: #cddc39;
        }
        
        #Bitter {
            background-color: #ffc107;
        }
        
        #Green {
            background-color: #8bc34a;
        }
        
        #Blue {
            background-color: #2196f3;
        }
        
        #Brightness {
            background-color: #949494;
        }
        
        .girl {
            width: 220px;
            height: 126px;
            object-fit: contain;
        }
        
        #circles {
            height: 200px;
            display: inline-grid;
            margin: 20px;
        }
        
        #circles>div,
        .fourth .right-panel>div {
            width: 25px;
            height: 25px;
            border-radius: 63% 37% 43% 57% / 55% 48% 52% 45%;
            box-shadow: 0 14px 28px rgb(0 0 0 / 25%), 0 10px 10px rgb(0 0 0 / 22%);
        }
        
        #circles>div:first-child,
        .fourth .right-panel>div:first-child {
            background-color: #9c27b0;
        }
        
        #circles>div:nth-child(2),
        .fourth .right-panel>div:nth-child(2) {
            background-color: #f44336;
            border-radius: 58% 42% 51% 49% / 44% 53% 47% 56%;
        }
        
        #circles>div:nth-child(3),
        .fourth .right-panel>div:nth-child(3) {
            background-color: #8bc34a;
            border-radius: 34% 36% 33% 67% / 39% 43% 47% 51%;
        }
        
        #circles>div:nth-child(4),
        .fourth .right-panel>div:nth-child(4) {
            background-color: #2196f3;
            border-radius: 58% 42% 36% 64% / 58% 63% 37% 42%;
        }
        
        #circles>div:nth-child(5),
        .fourth .right-panel>div:nth-child(5) {
            background-color: #cddc39;
            border-radius: 78% 42% 51% 39% / 64% 43% 47% 36%;
        }
        
        .fourth .right-panel>div:first-child {
            position: relative;
            top: 15px;
            left: 10px;
        }
        
        .fourth .right-panel>div:nth-child(2) {
            position: relative;
            top: -40px;
        }
        
        .fourth .right-panel>div:nth-child(3) {
            position: relative;
            top: 55px;
        }
        
        .fourth .right-panel>div:nth-child(4) {
            position: relative;
            top: -40px;
        }
        
        .fourth .right-panel>div:nth-child(5) {
            position: relative;
            top: 15px;
            right: 10px;
        }
        
        .fourth .left-panel {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
        }
        
        .fourth .right-panel {
            height: 240px;
            width: 200px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 13px;
            background-color: #e7e7e7;
            border: 1px solid #ccc;
            border-left-width: 0px;
        }
        /* color picker */
        
        .color-picker-container .picker-container .canvas-container {
            margin: 20px 0px;
            position: relative;
            width: 200px;
            display: inline-block;
        }
        
        .color-picker-container .picker-container .canvas-container.active {
            display: block;
        }
        
        .color-picker-container .picker-container .canvas-container canvas {
            cursor: crosshair;
            border-radius: 50%;
            box-shadow: 0px 0px 20px 5px rgb(158 158 158 / 69%);
        }
        
        .color-picker-container .picker-container .canvas-container .pointer {
            width: 15px;
            height: 15px;
            border: 2px solid #fff;
            border-radius: 50%;
            position: absolute;
            pointer-events: none;
            background: rgba(0, 0, 0, 0.1);
        }
        
        .color-picker-container .picker-container .slider-container {
            width: 15px;
            float: right;
            position: relative;
            margin: 20px;
        }
        
        .color-picker-container .picker-container .slider-container .slider {
            width: 15px;
            height: 200px;
            background: #000;
            box-shadow: 0px 0px 20px 5px rgb(158 158 158 / 69%);
        }
        
        .color-picker-container .picker-container .slider-container .pointer {
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 5px 0 5px 10px;
            border-color: transparent transparent transparent #9e9e9e;
            position: absolute;
            left: -8px;
        }
        
        .color-picker-container .picker-container .canvas-container input {
            display: none;
        }
    </style>
</head>

<body>
    <div class="main">
        <div class="left-panel">
            <div>
                <img class="food" src="assets/color/Asset6.png" onmouseover="hoverImage(this, 1)" />
                <img class="food" src="assets/color/Asset1.png" onmouseover="hoverImage(this, 2)" />
                <img class="food" src="assets/color/Asset8.png" onmouseover="hoverImage(this, 3)" />
                <img class="food" src="assets/color/Asset2.png" onmouseover="hoverImage(this, 4)" />
            </div>
            <div>
                <img class="food" src="assets/color/Asset3.png" onmouseover="hoverImage(this, 5)" />
                <img class="food" src="assets/color/Asset5.png" onmouseover="hoverImage(this, 6)" />
                <img class="food" src="assets/color/Asset4.png" onmouseover="hoverImage(this, 7)" />
                <img class="food" src="assets/color/Asset7.png" onmouseover="hoverImage(this, 8)" />
            </div>
        </div>
        <div class="right-panel">
            <label><i>Tastes:</i></label>
            <hr>
            <div>
                <label>Sweet:</label>
                <div class="progress-container">
                    <div class="progress" id="Sweet"></div>
                </div>
            </div>
            <div>
                <label>Sour:</label>
                <div class="progress-container">
                    <div class="progress" id="Sour"></div>
                </div>
            </div>
            <div>
                <label>Salty:</label>
                <div class="progress-container">
                    <div class="progress" id="Salty"></div>
                </div>
            </div>
            <div>
                <label>Bitter:</label>
                <div class="progress-container">
                    <div class="progress" id="Bitter"></div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="main second">
        <div class="left-panel">
            <img class="girl" src="assets/girl/renoir girl can - upper.jpg" id="girl" />
        </div>
        <div class="right-panel">
            <label><i>Colors:</i></label>
            <hr>
            <div>
                <label>Green or red:</label>
                <div class="progress-container">
                    <div class="progress" id="Green"></div>
                </div>
            </div>
            <div>
                <label>Blue or yellow:</label>
                <div class="progress-container">
                    <div class="progress" id="Blue"></div>
                </div>
            </div>
            <div>
                <label>Brightness:</label>
                <div class="progress-container">
                    <div class="progress" id="Brightness"></div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="main fourth">
        <div class="left-panel">
            <div id="circles">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="picker"></div>
        </div>
        <div class="right-panel" id="painting">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</body>

<script type="text/javascript">
    const progressbar = [
        document.querySelector("#Sweet"),
        document.querySelector("#Sour"),
        document.querySelector("#Salty"),
        document.querySelector("#Bitter"),
        document.querySelector("#Green"),
        document.querySelector("#Blue"),
        document.querySelector("#Brightness")
    ];

    const changeProgress = [];

    for (let index = 0; index < 7; index++) {
        changeProgress[index] = (progress, color) => {
            progressbar[index].style.width = `${progress}%`;
            progressbar[index].style.backgroundColor = `${color}`;
        };
    }

    const data = [
        [100, 25, 0, 0],
        [25, 0, 100, 0],
        [25, 100, 75, 0],
        [0, 20, 0, 100],
        [25, 100, 0, 25],
        [25, 25, 50, 0],
        [100, 0, 25, 0],
        [20, 0, 0, 80]
    ];

    function hoverImage(object, inx) {

        const highlightedItems = document.querySelectorAll("img.food");

        highlightedItems.forEach(function(userItem) {
            userItem.style.opacity = 0.5;
            userItem.style.transform = 'scale(1)';
        });

        object.style.opacity = 1;
        object.style.transform = 'scale(1.1)';

        /* change progress after 0.2 second (only for showcase) */
        changeProgress[0](data[inx - 1][0], '#9c27b0');
        changeProgress[1](data[inx - 1][1], '#f44336');
        changeProgress[2](data[inx - 1][2], '#cddc39');
        changeProgress[3](data[inx - 1][3], '#ffc107');
    }

    //select girl image
    let girl = document.getElementById("girl");

    //from green (120) to red(0) 
    //from blue (240) to yellow (360 + 60)

    // This handler will be executed only once when the cursor
    girl.addEventListener("mousemove", function(event) {
        if (!this.canvas) {
            this.canvas = document.createElement('canvas');
            this.canvas.width = this.width;
            this.canvas.height = this.height;
            this.canvas.getContext('2d').drawImage(this, 0, 0, this.width, this.height);
        }

        var pixelData = this.canvas.getContext('2d').getImageData(event.offsetX, event.offsetY, 1, 1).data;
        var yellow = (pixelData[1] + pixelData[2]) / 2;
        //green to red
        changeProgress[6](rgb2lab(pixelData)[0], '#949494');

        if (rgb2lab(pixelData)[1] < 0) {
            changeProgress[4](rgb2lab(pixelData)[1] * (-3), '#8bc34a');
        } else {
            changeProgress[4](rgb2lab(pixelData)[1] * 2, '#e91e63');
        }

        if (rgb2lab(pixelData)[2] < 0) {
            changeProgress[5](rgb2lab(pixelData)[2] * (-3), '#3f51b5');
        } else {
            changeProgress[5](rgb2lab(pixelData)[2] * 2, '#ffeb3b');
        }
    }, false);

    girl.addEventListener("touchmove", function(event) {
        if (!this.canvas) {
            this.canvas = document.createElement('canvas');
            this.canvas.width = this.width;
            this.canvas.height = this.height;
            this.canvas.getContext('2d').drawImage(this, 0, 0, this.width, this.height);
        }

        var pixelData = this.canvas.getContext('2d').getImageData(event.offsetX, event.offsetY, 1, 1).data;
        var yellow = (pixelData[1] + pixelData[2]) / 2;
        //green to red
        changeProgress[6](rgb2lab(pixelData)[0], '#949494');

        if (rgb2lab(pixelData)[1] < 0) {
            changeProgress[4](rgb2lab(pixelData)[1] * (-3), '#8bc34a');
        } else {
            changeProgress[4](rgb2lab(pixelData)[1] * 2, '#e91e63');
        }

        if (rgb2lab(pixelData)[2] < 0) {
            changeProgress[5](rgb2lab(pixelData)[2] * (-3), '#3f51b5');
        } else {
            changeProgress[5](rgb2lab(pixelData)[2] * 2, '#ffeb3b');
        }
    }, false);

    function rgb2lab(rgb) {
        var r = rgb[0] / 255,
            g = rgb[1] / 255,
            b = rgb[2] / 255,
            x, y, z;

        r = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;
        g = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;
        b = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;

        x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047;
        y = (r * 0.2126 + g * 0.7152 + b * 0.0722) / 1.00000;
        z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883;

        x = (x > 0.008856) ? Math.pow(x, 1 / 3) : (7.787 * x) + 16 / 116;
        y = (y > 0.008856) ? Math.pow(y, 1 / 3) : (7.787 * y) + 16 / 116;
        z = (z > 0.008856) ? Math.pow(z, 1 / 3) : (7.787 * z) + 16 / 116;

        return [(116 * y) - 16, 500 * (x - y), 200 * (y - z)]
    }
</script>

<script type="text/javascript">
    var ColorPicker;

    (function() {

        function insertBefore(element, before) {
            parent = before.parentNode;
            parent.insertBefore(element, before);
        }

        function extend(defaults, options) {
            var extended = {};
            var prop;
            for (prop in defaults) {
                if (Object.prototype.hasOwnProperty.call(defaults, prop)) {
                    extended[prop] = defaults[prop];
                }
            }
            for (prop in options) {
                if (Object.prototype.hasOwnProperty.call(options, prop)) {
                    extended[prop] = options[prop];
                }
            }
            return extended;
        };

        function hasClass(element, classname) {
            var className = " " + classname + " ";
            if ((" " + element.className + " ").replace(/[\n\t]/g, " ").indexOf(" " + classname + " ") > -1) {
                return true;
            }
            return false;
        }

        function removeClass(node, className) {
            node.className = node.className.replace(
                new RegExp('(^|\\s+)' + className + '(\\s+|$)', 'g'),
                '$1'
            ).replace(/ +(?= )/g, '').trim();
        }

        function addClass(element, className) {
            if (!hasClass(element, className)) {
                element.className += ' ' + className;
                element.className = element.className.replace(/ +(?= )/g, '').trim()
            }
        }

        ColorPicker = function(element, options) {

            this.options = extend({
                color: '#e7e7e7',
                palettes: ['#646fff', '#fffa1d', '#ffa21f', '#ff391d'],
                onUpdate: function() {}
            }, options);

            this.options.palettes.unshift(this.options.color);

            this.hex = this.options.color;
            this.rgb = this.HEXtoRGB(this.hex);
            this.hsv = this.RGBtoHSV(this.rgb[0], this.rgb[1], this.rgb[2]);
            this.dom = {};
            this.dom.container = document.createElement('div');
            this.dom.container.className = 'color-picker-container';

            element.appendChild(this.dom.container);

            this.initPicker();

            this.initPalettes();
        }

        ColorPicker.prototype.initPicker = function() {

            this.dom.picker = {};
            this.dom.picker.container = document.createElement('div');
            this.dom.picker.container.className = 'picker-container';

            this.dom.container.appendChild(this.dom.picker.container);

            this.dom.picker.canvas = {};

            this.dom.picker.canvas.container = document.createElement('div');
            this.dom.picker.canvas.container.className = 'canvas-container';
            this.dom.picker.container.appendChild(this.dom.picker.canvas.container);

            this.dom.picker.canvas.canvas = document.createElement('canvas');
            this.dom.picker.canvas.canvas.className = 'canvas';

            this.dom.picker.canvas.pointer = document.createElement('div');
            this.dom.picker.canvas.pointer.className = 'pointer';

            var ctx = this.dom.picker.canvas.canvas.getContext('2d'),
                image = new Image,
                $this = this,
                dragging = false;

            this.dom.picker.canvas.canvas.setAttribute('width', 200);
            this.dom.picker.canvas.canvas.setAttribute('height', 200);
            this.dom.picker.canvas.container.appendChild(this.dom.picker.canvas.canvas);
            this.dom.picker.canvas.container.appendChild(this.dom.picker.canvas.pointer);

            image.src = 'assets/wheel.png';

            image.onload = function() {
                $this.updateCanvasBounds();
                ctx.drawImage(image, 0, 0, 200, 200);
                $this.updateCoordinates($this.dom.picker.canvas.canvas.bounds.centerX, $this.dom.picker.canvas.canvas.bounds.centerY);
                coordinates = $this.getPositionFromColor($this.hex);
                if (coordinates != null) {
                    $this.x = coordinates.x;
                    $this.y = coordinates.y;
                    $this.updateColor($this.HEXtoRGB($this.hex));
                    $this.updateAll();
                }
                $this.options.onUpdate($this.rgb);
            };

            this.dom.picker.canvas.canvas.addEventListener('mousedown', function(e) {
                e.preventDefault();
                dragging = true;
                $this.updateCoordinates(e.clientX, e.clientY);
                imageData = ctx.getImageData($this.x, $this.y, 1, 1);
                $this.updateColor(imageData.data);
                $this.hsv[2] = 1;
                $this.updateAll();
            });

            document.addEventListener('mousemove', function(e) { // mouse move handler
                if (dragging) {
                    $this.updateCoordinates(e.pageX, e.pageY);
                    imageData = ctx.getImageData($this.x, $this.y, 1, 1);
                    $this.updateColor(imageData.data);
                    $this.hsv[2] = 1;
                    $this.updateAll();
                }
            });

            document.addEventListener('mouseup', function(e) { // click event handler
                dragging = false;
            });

            this.dom.picker.canvas.input = document.createElement('input'), this.dom.picker.canvas.container.appendChild(this.dom.picker.canvas.input);

            this.dom.picker.canvas.input.addEventListener('keyup', function() {
                if (this.value == $this.hex || '#' + this.value == $this.hex) {
                    return;
                }
                coordinates = $this.getPositionFromColor(this.value);
                if (coordinates != null) {
                    $this.x = coordinates.x;
                    $this.y = coordinates.y;
                    $this.updateColor($this.HEXtoRGB(this.value));
                    $this.updateAll();
                }
            });

            this.initSlider();

        }

        ColorPicker.prototype.initSlider = function() {

            this.dom.slider = {};
            this.dom.slider.container = document.createElement('div');
            this.dom.slider.container.className = 'slider-container';

            this.dom.slider.slider = document.createElement('div');
            this.dom.slider.slider.className = 'slider';

            this.dom.slider.pointer = document.createElement('div');
            this.dom.slider.pointer.className = 'pointer';

            this.dom.slider.container.appendChild(this.dom.slider.pointer);
            this.dom.slider.container.appendChild(this.dom.slider.slider);
            this.dom.picker.container.appendChild(this.dom.slider.container);

            this.dom.slider.slider.bounds = this.dom.slider.slider.getBoundingClientRect();
            this.dom.slider.pointer.bounds = this.dom.slider.pointer.getBoundingClientRect();

            this.redrawSlider();

            var dragging = false,
                $this = this;

            this.dom.slider.slider.addEventListener('mousedown', function(e) {
                e.preventDefault();
                dragging = true;
                total = $this.updateSliderCursor(e.clientY);
                $this.updateColor($this.HSVtoRGB($this.hsv[0], $this.hsv[1], 1 - total));
                $this.updateAll();
            });

            this.dom.slider.pointer.addEventListener('mousedown', function(e) {
                e.preventDefault();
                dragging = true;
                total = $this.updateSliderCursor(e.clientY);
                $this.updateColor($this.HSVtoRGB($this.hsv[0], $this.hsv[1], 1 - total));
                $this.updateAll();
            });

            document.addEventListener('mousemove', function(e) {
                if (!dragging) {
                    return;
                }
                total = $this.updateSliderCursor(e.clientY);
                $this.updateColor($this.HSVtoRGB($this.hsv[0], $this.hsv[1], 1 - total));
                $this.updateAll();
            });

            document.addEventListener('mouseup', function() {
                dragging = false;
            });
        };

        ColorPicker.prototype.updateColor = function(pixel) {
            this.hex = hex = this.RGBtoHEX(pixel[0], pixel[1], pixel[2]);
            this.hsv = this.RGBtoHSV(pixel[0], pixel[1], pixel[2]);
            this.rgb = [
                pixel[0],
                pixel[1],
                pixel[2]
            ];
        }

        ColorPicker.prototype.updateCoordinates = function(x, y) {
            var angle = Math.atan2((y - this.dom.picker.canvas.canvas.bounds.centerY), (x - this.dom.picker.canvas.canvas.bounds.centerX));
            radius = Math.sqrt(Math.pow(x - this.dom.picker.canvas.canvas.bounds.centerX, 2) + Math.pow(y - this.dom.picker.canvas.canvas.bounds.centerY, 2));
            if (radius > this.dom.picker.canvas.canvas.bounds.radius - (this.dom.picker.canvas.pointer.bounds.width / 2)) {
                cos = Math.cos(angle);
                sin = Math.sin(angle);
                x = cos * (this.dom.picker.canvas.canvas.bounds.radius - (this.dom.picker.canvas.pointer.bounds.width / 2)) + this.dom.picker.canvas.canvas.bounds.centerX;
                y = sin * (this.dom.picker.canvas.canvas.bounds.radius - (this.dom.picker.canvas.pointer.bounds.width / 2)) + this.dom.picker.canvas.canvas.bounds.centerY;
            }
            this.x = Math.floor(x - this.dom.picker.canvas.canvas.bounds.left);
            this.y = Math.floor(y - this.dom.picker.canvas.canvas.bounds.top);
        }

        ColorPicker.prototype.initPalettes = function() {
            this.dom.palettes = {};
            this.dom.palettes.list = [];
        }

        ColorPicker.prototype.updateAll = function() {
            this.redrawSlider();
            this.updatePointers();
            this.dom.picker.canvas.input.value = this.hex;
            this.options.onUpdate(this.rgb);
            if (this.selectedPalette) {
                this.selectedPalette.style.background = this.hex;
            }
        }
        ColorPicker.prototype.getPositionFromColor = function(color) {
            color = this.HEXtoRGB(color);
            if (color == null) {
                return null;
            }
            this.hsv = this.RGBtoHSV(color[0], color[1], color[2]);
            return this.getSVGPositionFromHS(this.hsv[0], this.hsv[1]);
        }

        ColorPicker.prototype.updateSliderCursor = function(y) {
            total = y - this.dom.slider.slider.bounds.top - 6;
            total = this.dom.slider.slider.bounds.height - total;
            total = total / this.dom.slider.slider.bounds.height;
            total = total.toFixed(2);
            if (total < 0) {
                total = 0;
            } else if (total > 1) {
                total = 1;
            }
            total = 1 - total;
            this.dom.slider.pointer.style.top = this.dom.slider.slider.bounds.height * total - (this.dom.slider.pointer.bounds.height / 2) + 'px';
            return total;
        }

        ColorPicker.prototype.redrawSlider = function() {
            rgb = this.HSVtoRGB(this.hsv[0], this.hsv[1], 1);
            hex = this.RGBtoHEX(rgb[0], rgb[1], rgb[2]);
            gradient = this.makeGradient(hex, '#000');
            this.dom.slider.slider.setAttribute('style', gradient);
            this.updatePointers();
        };

        ColorPicker.prototype.updatePointers = function() {
            if (this.dom.picker.canvas.pointer.bounds) {
                this.dom.picker.canvas.pointer.style.left = this.x - (this.dom.picker.canvas.pointer.bounds.width / 2) + 'px';
                this.dom.picker.canvas.pointer.style.top = this.y - (this.dom.picker.canvas.pointer.bounds.height / 2) + 'px';
            }
            if (this.dom.slider.slider.bounds) {
                position = this.dom.slider.slider.bounds.height * (1 - this.hsv[2]) - (this.dom.slider.pointer.bounds.height / 2);
                this.dom.slider.pointer.style.top = position + 'px';
            }
        }

        ColorPicker.prototype.updateCanvasBounds = function() {
                this.dom.picker.canvas.canvas.bounds = this.dom.picker.canvas.canvas.getBoundingClientRect();
                this.dom.picker.canvas.pointer.bounds = this.dom.picker.canvas.pointer.getBoundingClientRect();
                this.dom.picker.canvas.canvas.bounds.centerX = this.dom.picker.canvas.canvas.bounds.left + (this.dom.picker.canvas.canvas.bounds.width / 2);
                this.dom.picker.canvas.canvas.bounds.centerY = this.dom.picker.canvas.canvas.bounds.top + (this.dom.picker.canvas.canvas.bounds.height / 2);
                this.dom.picker.canvas.canvas.bounds.radius = this.dom.picker.canvas.canvas.bounds.width / 2;
            }
            // Get a coordinate pair from hue and saturation components.
        ColorPicker.prototype.getSVGPositionFromHS = function(h, s) {
            var hue = this.scientificToArtisticSmooth(h * 360);
            var theta = hue * (Math.PI / 180);
            var y = Math.sin(theta) * this.dom.picker.canvas.canvas.bounds.radius * s;
            var x = Math.cos(theta) * this.dom.picker.canvas.canvas.bounds.radius * s;
            return {
                x: x + this.dom.picker.canvas.canvas.bounds.radius,
                y: this.dom.picker.canvas.canvas.bounds.radius - y
            }

        };
        ColorPicker.prototype.scientificToArtisticSmooth = function(hue) {
            return (
                hue < 35 ? hue * (60 / 35) :
                hue < 60 ? this.mapRange(hue, 35, 60, 60, 122) :
                hue < 120 ? this.mapRange(hue, 60, 120, 122, 165) :
                hue < 180 ? this.mapRange(hue, 120, 180, 165, 218) :
                hue < 240 ? this.mapRange(hue, 180, 240, 218, 275) :
                hue < 300 ? this.mapRange(hue, 240, 300, 275, 330) :
                this.mapRange(hue, 300, 360, 330, 360));
        }
        ColorPicker.prototype.mapRange = function(value, fromLower, fromUpper, toLower, toUpper) {
            return (toLower + (value - fromLower) * ((toUpper - toLower) / (fromUpper - fromLower)));
        }
        ColorPicker.prototype.HEXtoRGB = function(hex) {
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? [
                parseInt(result[1], 16),
                parseInt(result[2], 16),
                parseInt(result[3], 16)
            ] : null;
        }
        ColorPicker.prototype.RGBtoHSV = function(r, g, b) {
            r = r / 255, g = g / 255, b = b / 255;
            var max = Math.max(r, g, b),
                min = Math.min(r, g, b);
            var h, s, v = max;

            var d = max - min;
            s = max == 0 ? 0 : d / max;

            if (max == min) {
                h = 0; // achromatic
            } else {
                switch (max) {
                    case r:
                        h = (g - b) / d + (g < b ? 6 : 0);
                        break;
                    case g:
                        h = (b - r) / d + 2;
                        break;
                    case b:
                        h = (r - g) / d + 4;
                        break;
                }
                h /= 6;
            }
            return [h, s, v];
        }
        ColorPicker.prototype.HSVtoRGB = function(h, s, v) {
            var r, g, b;
            var i = Math.floor(h * 6);
            var f = h * 6 - i;
            var p = v * (1 - s);
            var q = v * (1 - f * s);
            var t = v * (1 - (1 - f) * s);
            switch (i % 6) {
                case 0:
                    r = v, g = t, b = p;
                    break;
                case 1:
                    r = q, g = v, b = p;
                    break;
                case 2:
                    r = p, g = v, b = t;
                    break;
                case 3:
                    r = p, g = q, b = v;
                    break;
                case 4:
                    r = t, g = p, b = v;
                    break;
                case 5:
                    r = v, g = p, b = q;
                    break;
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }
        ColorPicker.prototype.RGBtoHEX = function(r, g, b) {
            function componentToHex(c) {
                var hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }
            return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
        }
        ColorPicker.prototype.makeGradient = function(colour1, colour2) {
            var gradientString = '\
           /* Mozilla Firefox */ \
           background-image: -moz-linear-gradient(top, {colour1} 0%, {colour2} 100%);\
           /* Opera */ \
           background-image: -o-linear-gradient(top, {colour1} 0%, {colour2} 100%);\
           /* Webkit (Safari/Chrome 10) */ \
           background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, {colour1}), color-stop(1, {colour2}));\
           /* Webkit (Chrome 11+) */ \
           background-image: -webkit-linear-gradient(top, {colour1} 0%, {colour2} 100%);\
           /* IE10+ */\
           background: -ms-linear-gradient(top,  {colour1} 0%,{colour2} 100%);\
           /* W3C */\
           background: linear-gradient(top,  {colour1} 0%,{colour2} 100%);\
       ';

            return gradientString.replace(/\{colour1\}/g, colour1).replace(/\{colour2\}/g, colour2)
        };
    }());

    var picker = new ColorPicker(document.getElementById('picker'), {
        onUpdate: function(rgb) {
            var painting = document.getElementById('painting');
            painting.style.background = "rgb(" + rgb[0] + ", " + rgb[1] + ", " + rgb[2] + ")";
        }
    });
</script>

</html>